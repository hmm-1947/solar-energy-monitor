# Solar Energy Monitor

This project is a solar and energy monitoring system built using an ESP32 and a Flutter application.  
It reads data from a Growatt MIN 5000 XTL solar inverter using Modbus RTU over RS485, sends the data to Firebase Realtime Database, and displays it in a Flutter dashboard.

---

## What this project does

- Reads live data from the solar inverter using RS485 (Modbus RTU)
- Stores live and historical energy data in Firebase Realtime Database
- Displays real-time values and energy history in a Flutter app
- Tracks daily, monthly, and yearly energy generation

---

## Hardware used

- Growatt MIN 5000 XTL solar inverter
- ESP32 development board
- MAX485 RS485 to TTL converter module
- Connecting wires
- WiFi network

---

## Communication

- Protocol: Modbus RTU
- Physical layer: RS485
- Converter: MAX485
- ESP32 communicates with the inverter using UART
- ESP32 sends data to Firebase using WiFi

---

## Wiring (MAX485 to ESP32 and inverter)

### Inverter to MAX485
- Inverter RS485 A  → MAX485 A
- Inverter RS485 B  → MAX485 B

### MAX485 to ESP32
- MAX485 RO  → ESP32 RX
- MAX485 DI  → ESP32 TX
- MAX485 DE  → ESP32 GPIO (enable)
- MAX485 RE  → ESP32 GPIO (enable, usually tied with DE)
- MAX485 VCC → ESP32 5V or 3.3V (as per module)
- MAX485 GND → ESP32 GND

---

## Data read from inverter

### Live data
Stored under `/live` in Firebase.

- PV voltage
- PV current
- AC output power
- Grid voltage
- Grid current
- Grid frequency
- Total working hours
- Inverter status text

Live values are updated only when the value changes, to reduce database writes.

---

### Energy data
Stored under `/energy` in Firebase.

- Daily energy (kWh)
- Monthly energy (kWh)
- Yearly energy (kWh)

Baselines are used internally to correctly calculate monthly and yearly values.

---

## ESP32 setup

1. Open the `esp32` folder
2. Create a file called `secrets.h`
3. Add WiFi and Firebase credentials in `secrets.h`
4. Flash the code to ESP32
5. ESP32 will start reading inverter data and pushing to Firebase

Example files:
- `secrets.h` (not committed)
- `secrets.example.h` (reference only)

---

## Flutter app setup

1. Open the `flutter_app` folder
2. Run `flutter pub get`
3. Run the app on Android or desktop
4. The app reads data directly from Firebase

Firebase configuration is done using `firebase_options.dart` generated by FlutterFire CLI.

---

## Firebase usage and security

- ESP32 authenticates using Firebase email and password
- ESP32 has write access to the database
- Flutter app only reads data
- Security is enforced using Firebase Realtime Database rules

---

## License

MIT License

---

